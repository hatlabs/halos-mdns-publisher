# Lefthook configuration for halos-mdns-publisher
# Install with: lefthook install
#
# NOTE: This is a Linux-only project. Cargo commands run in Docker.

pre-commit:
  parallel: true
  commands:
    cargo-fmt:
      glob: "*.rs"
      # rustfmt can run natively - no Linux-specific dependencies
      run: cargo fmt --check
      fail_text: "Rust formatting check failed. Run 'cargo fmt' to fix."

    cargo-clippy:
      glob: "*.rs"
      # Must run in Docker due to Linux-only dependencies
      run: ./run clippy
      fail_text: "Clippy found issues. Fix the warnings above."

    cargo-test:
      glob: "*.rs"
      # Must run in Docker due to Linux-only dependencies
      run: ./run test
      fail_text: "Tests failed. Fix the failing tests above."

    check-hostnames:
      run: .github/scripts/check-hardcoded-hostnames.sh
      fail_text: "Hard-coded hostname references found. See error above for details."

    check-changelog:
      run: .github/scripts/check-changelog-edits.sh
      fail_text: "Direct debian/changelog edits are not allowed. Use './run bumpversion' instead."
